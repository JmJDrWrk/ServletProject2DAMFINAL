var cartTimeout,$userLayer=$(".js-user-menu"),$carritoHeader=$(".js-user-cart").parent(),$pcComBasket=$("#pccom-basket");function updateUserLayer(s){$userLayer.length&&"undefined"==typeof $blackFriday?$.ajax({url:Routing.generate("pcc_web_user_ajax"),dataType:"HTML",method:"GET",cache:!1,success:function(t){var e,i,a;s?(i=(e=$("<div></div>").html(t)).find(".js-units").text(),a=e.find("#pccom-basket").children(),$carritoHeader.find(".js-units").text(i),checkIfDeviceIsWindows()?document.querySelector("#pccom-basket").innerHTML=a.html():($pcComBasket.html(a),$pcComBasket.siblings("script").replaceWith(e.find("script"))),closeCart(),closeUserPanel()):($userLayer.html(t),PccUserId.save()),$(".js-user-menu-link").on("click",function(t){t.preventDefault(),$(window).width()<768&&t.preventDefault()})}}):$(".input-units").length&&$(".input-units").trigger("change")}function closeCart(){var t;$carritoHeader=$(".js-user-cart"),$pcComBasket=$("#pccom-basket"),t=t||750,cartTimeout=setTimeout(function(){document.querySelector("#pccom-basket").parentElement.classList.remove("open"),document.querySelector(".pccom-basket__loading").style.display="none"},t)}function closeUserPanel(){var t;$pcComBasket=$("#pccom-usuario-drop"),t=t||750,cartTimeout=setTimeout(function(){document.querySelector("#pccom-usuario-drop").parentElement.classList.remove("open")},t)}function getCleanedString(t){for(var e="!@#$^&%*()+=-[]{}|:<>?,.",i=0;i<e.length;i++)t=t.replace(new RegExp("\\"+e[i],"gi"),"");return t=(t=(t=(t=(t=(t=(t=(t=(t=t.toLowerCase()).replace(/ /g,"_")).replace(/[/]/g,"_")).replace(/á/gi,"a")).replace(/é/gi,"e")).replace(/í/gi,"i")).replace(/ó/gi,"o")).replace(/ú/gi,"u")).replace(/ñ/gi,"n")}function confirmArticle(t,e){t.length?(t={idArticle:t.join(",")},$.ajax({url:Routing.generate("pcc_articles_confirm_availiability"),data:t,dataType:"json",method:"get",async:!1,success:function(t){"function"==typeof e&&e(t)},error:function(t){}})):console.error("You must supply an array of ids")}function checkIfDeviceIsWindows(){return!!(0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./))}function getDomainName(){return document.querySelector(".js-theme-data").dataset.name.toLowerCase()}document.addEventListener("click",function(t){var e=t.target||t.currentTarget||t.relatedTarget,t=document.querySelector("#pccom-basket");t&&(t=t.parentElement,e.classList.contains("js-user-cart")||e.classList.contains("js-pcc-open-cart")?($("#main-menu").hasClass("is-active")&&($("#close-main-menu").click(),$("#close-main-menu").css("display","none"),$("#open-main-menu").css("display","block")),t.classList.add("open")):"block"!==document.querySelector(".pccom-basket__loading").style.display&&t.classList.remove("open"))}),function(s){var a=a||{};a.ListenerLoader=function(){this.idCont=0,this.listeners=[]},a.ListenerLoader.prototype.get=function(t){if(t.is("["+a.options.attr_id_listener+"]"))return this.listeners[t.attr(a.options.attr_id_listener)];var e=new a.Listener(t);return t.attr(a.options.attr_id_listener,this.idCont),this.listeners[this.idCont++]=e};var r=new a.ListenerLoader;a.options={attr_trigger:"data-pcc-trigger",attr_event:"data-pcc-event",attr_group:"data-pcc-group",attr_listener:"data-pcc-listen",attr_class:"data-pcc-class",attr_active_init:"data-pcc-active",attr_id_listener:"data-pcc-id-listener",attr_after:"data-pcc-after"},a.Observer=function(t){this.observer=t,this.name=this.observer.attr(a.options.attr_trigger),this.group=this.observer.attr(a.options.attr_group),this.loadListeners(),this.loadGroups(),this.loadEvent()},a.Observer.prototype.loadGroups=function(){var t;this.groups=[],this.group&&s("*["+a.options.attr_group+"="+(t=this).group+"]["+a.options.attr_listener+"]["+a.options.attr_listener+"!="+this.name+"]").each(function(){t.groups.push(r.get(s(this)))})},a.Observer.prototype.loadListeners=function(){this.listeners=[];var i=this;s("*["+a.options.attr_listener+"="+this.name+"]["+a.options.attr_class+"]").each(function(){var t=s(this),e=r.get(t);i.listeners.push(e),jQuery.data(t,"listener",e)})},a.Observer.prototype.loadEvent=function(){var t=this;switch(this.observer.attr(a.options.attr_event)){case"hover":this.observer.on("mouseenter",function(){t.notify()}).on("mouseleave",function(){t.notify()});break;case"checked":this.observer.on("change",function(){t.notify()});break;default:this.observer.on("click",function(){t.notify()})}},a.Observer.prototype.notify=function(){for(var t=0,e=this.groups.length;t<e;t++)this.groups[t].reset();for(t=0,e=this.listeners.length;t<e;t++)this.listeners[t].notify()},a.Listener=function(t){this.listener=t,this.class_name=this.listener.attr(a.options.attr_class),this.group=this.listener.attr(a.options.attr_group),this.initial_active=this.listener.is("["+a.options.attr_active_init+"]")?"1"==this.listener.attr(a.options.attr_active_init):this.listener.hasClass(this.class_name),this.current_active=this.listener.hasClass(this.class_name),this.after=this.listener.attr(a.options.attr_after)},a.Listener.prototype.notify=function(){this.current_active?(this.listener.removeClass(this.class_name),this.current_active=!1):(this.listener.addClass(this.class_name),this.current_active=!0),this.after&&this.listener.trigger(this.after)},a.Listener.prototype.reset=function(){this.initial_active?(this.listener.addClass(this.class_name),this.current_active=!0):(this.listener.removeClass(this.class_name),this.current_active=!1)},s(function(){var e=[];s("*["+a.options.attr_trigger+"]").each(function(){var t=new a.Observer(s(this));e.push(t)})});var t=s(".owl-carousel");s("#main-menu .c-main-menu__top-bar").click(function(){var t=document.body.style.overflow;document.body.style.overflow="hidden"===t?"auto":"hidden"}),s("#main-header-toggle").click(function(){var t=document.body.style.overflow;document.body.style.overflow="hidden"===t?"auto":"hidden"}),s(".c-main-menu__bg").click(function(){document.body.style.overflow="auto"}),s("#menu-principal").hover(function(){t.clearQueue().addClass("off-focus-slider")},function(){t.delay(400).queue(function(t){s(this).removeClass("off-focus-slider")})}),s("body").on("click",".btn-add-cart",function(t){var e=s(this),i=Routing.generate("pcc_cart_add_item_ajax",{idArticle:e.data("id")}),a={units:1,warranty:0};e.data("offer")&&(a.idOffer=e.data("offer")),$carritoHeader=s(".js-user-cart"),document.querySelector(".pccom-basket__loading").style.display="block",$pcComBasket=s("#pccom-basket"),e.attr("disabled",!0),e.stateButton("loading"),$carritoHeader.parent().addClass("open"),clearTimeout(cartTimeout),s.post(i,a,function(t){e.stateButton("reset"),updateUserLayer(!0)}).always(function(){e.removeAttr("disabled")}),this.dataset&&this.dataset.id&&document.dispatchEvent(new CustomEvent("add-to-cart",{detail:{articles:[{articleId:this.dataset.id,qty:this.dataset.qty||1}]}})),PCC.loadCometHunter&&(i=Routing.generate("pcc_web_comethunter"),a={event:"addToCart",quantity:s(this).data("qty"),id_item:s(this).data("id"),price:s(this).data("price"),brand:s(this).data("brand"),category:s(this).data("category"),name:s(this).data("name")},s.post(i,a,function(t){}),window._vteq=window._vteq||[],window._vteq.push({addtocart:{itemId:s(this).data("id")}}))}),s(window).resize(function(){991<s(window).width()&&s(".superfamilia--desplegada").removeClass("superfamilia--desplegada")}),document.addEventListener("DOMContentLoaded",function(t){updateUserLayer(),function(){/iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&s(".js-header-sep, .js-back-button").addClass("is-visible");s(".js-back-button").on("click",function(){window.history.back()})}()})}(jQuery);